SYSTEM = Fe
GGA = PE
GGA_COMPAT = .FALSE.
LASPH = .TRUE.

#Electronic minimization
PREC = Normal
ENCUT = 600
EDIFF = 1E-8
LORBIT  = 11
LREAL = .FALSE.
ISTART  = 0
NPAR  = 4
#ICHARG =  1
VOSKOWN = 1
LWAVE = .FALSE.
LCHARG = .FALSE.
NELMIN = 10
NELM = 500

#IBRION = 2 #OPT
#EDIFFG = -1E-3 #OPT
#ISIF = 3 #OPT
#NSW = 500 #OPT
#POTIM = 0.2  #OPT

#DOS
ISMEAR = 1
SIGMA = 0.05
#NEDOS = 3000 #DOS

#Magnetism
# The DEFINITION of atomic spins which are constrained (M_CONSTR in INCAR, MW in constrmag.F/OSZICAR):
# \vec{M}_{I}=
# \int_{\Omega_{I}} \vec{m}(\mathbf{r}) F_{I}(|\mathbf{r}|) d\mathbf{r}
ISYM = -1
RWIGS = 1.164                 # Better to be determined from Bader analysis
ISPIN = 2
LNONCOLLINEAR = .TRUE.
#LSORBIT  = .TRUE.

#SASC
I_CONSTRAINED_M = 2
MAGMOM   = 0.7194 -0.0231 1.3714 -1.1560 -0.0352 1.0305 
M_CONSTR = 0.7194 -0.0231 1.3714 -1.1560 -0.0352 1.0305 
SCTYPE = 1                     # Type of SASC calculation   0: noSASC  1: SASC(L)  2: SASC(Q)  3: SASC(QL)

#SASC(L)
IDECOSC = 1                    # Whether Lagragian coefficients are coupled   0: coupled  1: decoupled between atoms  2: decoupled between every Cartesian component
LAMBDA   = 0 0 0 0 0 0         # Initial Lagragian coefficients for SASC(L)
CONSTRL  = 1 1 1 1 1 1         # Whether the component is constrained or not   0: not constrained  1: constrained
NSC = 100                      # Maximum number of steps for inner optimization
SCDIFF = 1E-6                  # Convergence criterion of iteration (RMS)
SCDECAY = -1                   # Exponential decay of convergence criterion   -1: do not decay  >0,<1: exponential base
SCDIFFB = 1E-7                 # Lower bound of criterion decay, not gonna work if SCDECAY = -1  
SCCONVB = -1                   # Break condition for Lagragian coefficients difference between two inner steps   -1: do not use this condition 
INISC = 0.01                   # Initial trial step size
SCCUT = 3                      # Restriction of step size
NELMSCI = 1                    # Number of electronic steps BEFORE SASC(L)
NELMSCT = 0                    # Number of INTERMEDIATE normal electronic steps
IALGOSC = 1                    # Inner optimization algorithm   1: CG(F-R) 2: CG(P-R) 3: CG(H-S) 4: CG(D-Y)
IALGOSC_DIAG = 1               # Inner diagonalization algorithm   1: sub-space rotation  2: Blocked-Davidson  3: sub-space rotation with B-D for the last step
LCUTSC_TRIAL = .TRUE.          # Whether trial step size is updated acoording to last-step optimal value   TRUE: update  FALSE: do not update
LDESC = .FALSE.                # Debug mode   TRUE: on  FALSE: off

#SASC(Q)
LAMBDA_Q   = 10 10 10 10 10 10 # Initial Lagragian coefficients for SASC(Q)
CONSTRL_Q  = 1 1 1 1 1 1       # Whether the component is constrained or not   0: not constrained  1: constrained
NSC_Q = 500                    # Maximum number of steps for SASC(Q) iteration
SCDIFF_Q = 3E-4                # Convergence criterion of iteration (+Inf-Norm)
EDIFF_Q = 1E-6                 # Global break condition (EDIFF) for SASC(Q)
INISC_Q = 0.1                  # Initial trial step size
LDESC_Q = .FALSE.              # Debug mode   TRUE: on  FALSE: off

#Orbital mom.
#LORBMOM = T

#Mixer
AMIX      = 0.2
BMIX      = 0.0001
AMIX_MAG  = 0.8
BMIX_MAG  = 0.0001

#LSDA+U
LDAU      = .TRUE.
LDAUTYPE  = 2
LDAUL     = 2 -1
LDAUU     = 5.3 0.0 
LDAUJ     = 0.0 0.0 
LDAUPRINT = 2
LMAXMIX   = 4 
